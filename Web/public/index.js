!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.w={},n(n.s=26)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("webpack")},function(e,t){e.exports=require("webpack-bundle-analyzer")},function(e,t,n){const r=n(0).join;e.exports={output:{path:r(__dirname,"../public/assets"),publicPath:"/"},resolve:{extensions:[".js",".ts",".tsx"],modules:[r(__dirname,"../node_modules"),r(__dirname,"../src")]}}},function(e,t){e.exports=require("webpack-merge")},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WSMessage=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(23)),o=n(1);class i{constructor(e,t){Object.defineProperty(this,"type",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"payload",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),this.type=e,this.payload=t}toString(){return JSON.stringify({type:this.type,payload:this.payload})}}t.WSMessage=i;let s=new Map,u=new Map;var a={start:function(e){(0,o.log)("info","[WSS] WSS initializing");const t=new r.Server({server:e});(0,o.log)("info","[WSS] WSS ready");function n(){this.isAlive=!0}t.on("connection",(e,t)=>{(0,o.log)("info","[WSS] WS connection created, given ID 0");let r=e;r.id=0,u.set(r.id,r),e.on("pong",n),e.on("message",e=>{let t=this,n=JSON.parse(e),r=new i(n.type,n.payload);r.type,s.has(r.type)?s.get(r.type)(r,t.id):(0,o.log)("info","[WSS] no route for "+r.type+" exists")}),e.on("close",()=>{console.log("closed ws id "+this.id),u.delete(this.id)})}),setInterval(()=>{t.clients.forEach(e=>{let t=e;if(!1===t.isAlive)return(0,o.log)("info","[WSS] closing connection, heartbeat lost"),e.terminate();t.isAlive=!1,t.ping("",!1,e=>{(0,o.log)("warn",e.message)})})},3e4)},send:(e,t)=>{u.has(e)?u.get(e).send(t.toString()):console.log("message lost, "+e+" disconnected before server's response")},use:(e,t)=>{(0,o.log)("info","[WSS] registering route WS route: "+e),s.set(e,t)}};t.default=a},function(e,t){e.exports=require("./assets/app.server.js")},function(e,t){e.exports=require("./assets/stats.json")},function(e,t){e.exports=require("webpack-hot-server-middleware")},function(e,t){e.exports=require("webpack-hot-middleware")},function(e,t){e.exports=require("webpack-dev-middleware")},function(e,t,n){const r=n(7).readdirSync,o=n(0).join;e.exports=r(o(__dirname,"../node_modules")).filter(e=>!/\.bin|react-universal-component|require-universal-module|webpack-flush-chunks/.test(e)).reduce((e,t)=>(e[t]=`commonjs ${t}`,e),{})},function(e,t,n){const r=n(6),o=n(3),i=n(5),s=n(0).join,u=n(14);n(4).BundleAnalyzerPlugin;e.exports=r(i,{mode:"development",name:"server",target:"node",externals:u,entry:[s(__dirname,"../src/server/index")],devtool:"inline-source-map",output:{filename:"app.server.js",libraryTarget:"commonjs2"},module:{rules:[{test:/\.tsx?$/,use:{loader:"babel-loader",options:{presets:[["@babel/env",{targets:{node:"6.10"}}],"@babel/preset-react","@babel/preset-stage-0","@babel/preset-typescript"],plugins:["react-loadable/babel"]}}}]},plugins:[new o.optimize.LimitChunkCountPlugin({maxChunks:1})]})},function(e,t){e.exports=require("extract-css-chunks-webpack-plugin")},function(e,t,n){const r=n(6),o=n(3),i=n(5),s=n(0).join;n(16),n(4).BundleAnalyzerPlugin;e.exports=r(i,{mode:"development",name:"client",target:"web",entry:["webpack-hot-middleware/client?path=/__webpack_hmr&timeout=20000&reload=false&quiet=false&noInfo=false",s(__dirname,"../src/client/index")],devtool:"inline-source-map",output:{filename:"[name].client.js",chunkFilename:"[name].js"},module:{rules:[]},optimization:{splitChunks:{chunks:"all"}},plugins:[new o.HashedModuleIdsPlugin,new o.HotModuleReplacementPlugin]})},function(e,t){e.exports=require("amqplib")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerNewTestQueueConsumer=t.initializeChannel=t.initializeTestQueue=t.initializeConnection=void 0;var r=n(18),o=n(1);let i=[];const s=process.env.RMQ?process.env.RMQ:"rabbitmq";let u=()=>new Promise((e,t)=>{(0,o.log)("info","[RMQ] initializing on host "+s),(0,r.connect)("amqp://"+s).then(t=>{a(t),e(t)}).catch(e=>{"ECONNREFUSED"===e.code?((0,o.log)("warn","rabbitmq server cannot be reached @ "+s+", trying again in 1s"),setTimeout(u,1e3)):((0,o.log)("error","rabbitmq connection error: "+e.code),t(e))})});t.initializeConnection=u;const a=e=>{e.createChannel().then(e=>{e.assertQueue("q_tests",{durable:!1}),(0,o.log)("info","[RMQ] Waiting for messages in q_tests"),e.consume("q_tests",function(t){for(let e=0;e<i.length;e++)i[e](t.content.toString());e.ack(t)},{noAck:!1})}).catch(e=>{console.log(e)})};t.initializeTestQueue=a;t.initializeChannel=((e,t)=>new Promise((n,r)=>{e.createChannel().then(e=>{e.assertQueue(t,{durable:!1}),n(n=>e.sendToQueue(t,Buffer.from(n)))}).catch(e=>{console.log(e)})}));t.registerNewTestQueueConsumer=(e=>i.push(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n(2)),o=s(n(19)),i=s(n(8));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}const u=r.Router();let a;o.initializeConnection().then(e=>o.initializeChannel(e,"q_submit")).then(e=>a=e).catch(e=>console.log(e)),o.registerNewTestQueueConsumer(e=>{const t=e.split(" "),n=Number.parseInt(t.shift()),r=t.shift();console.log("sending TestInfo to client ("+n+")");const o=new i.WSMessage("TestInfo",{questionID:r,testInfo:JSON.parse(t.join(" "))});i.default.send(n,o)}),i.default.use("TestCode",(e,t)=>{console.log("received TestCode from client ("+t+")"),a(t+" "+e.payload.questionID+" "+e.payload.code),i.default.send(t,new i.WSMessage("CodeReceived",e.payload.questionID))}),u.get("/:content",function(){var e,t=(e=function*(e,t){return a("0 1 "+decodeURIComponent(e.params.content)),t.status(200).end()},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function s(e,t){try{var n=i[e](t),s=n.value}catch(e){return void o(e)}n.done?r(s):Promise.resolve(s).then(u,a)}function u(e){s("next",e)}function a(e){s("throw",e)}u()})});return function(e,n){return t.apply(this,arguments)}}());var l=u;t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(2)),o=n(1),i=u(n(7)),s=u(n(0));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}const a=r.Router(),l=s.resolve(s.join("repository","repository.json"));console.log(s.resolve(""));const c=JSON.parse(i.readFileSync(l,"utf-8"));(0,o.log)("info","Repository initialized at repository"),a.get("/",function(){var e,t=(e=function*(e,t){return t.status(200).json(c)},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function s(e,t){try{var n=i[e](t),s=n.value}catch(e){return void o(e)}n.done?r(s):Promise.resolve(s).then(u,a)}function u(e){s("next",e)}function a(e){s("throw",e)}u()})});return function(e,n){return t.apply(this,arguments)}}()),a.get("/:id",(e,t)=>{const n=s.join("repository","problemPrompts",e.params.id+".html");i.existsSync(n)?t.status(200).sendFile(s.resolve(n)):t.status(204).end()});var p=a;t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(2)),o=s(n(21)),i=s(n(20));function s(e){return e&&e.__esModule?e:{default:e}}const u=r.Router();u.use("/r",o.default),u.use("/submit",i.default);var a=u;t.default=a},function(e,t){e.exports=require("ws")},function(e,t,n){"use strict";var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(2)),o=n(0),i=n(1),s=a(n(8)),u=a(n(22));function a(e){return e&&e.__esModule?e:{default:e}}let l,c;process.env.PORT?(l=Number.parseInt(process.env.PORT),(0,i.log)("info","starting server on port "+l)):((0,i.log)("info","no port provided, starting server on 80"),l=80),c="production".toUpperCase().includes("PROD"),(0,i.log)("info","NODE_ENV is production which evaluates isProduction to "+c);const p=r();(0,i.log)("info","Configuring express routes..."),p.use("/api",u.default),(0,i.log)("info",`Configuring server for environment: ${c?"production":"development"}...`),c?(e=>{const t=n(10),i=n(9).default,s=(0,o.join)(__dirname,"assets");e.use("/",r.static(s)),e.use(i({clientStats:t,outputPath:s})),e.set("views",(0,o.join)(__dirname,"views"))})(p):(e=>{const t=n(17),i=n(15),s=t.output.publicPath,u=t.output.path,a=n(3)([t,i]),l=a.compilers[0];e.use(n(13)(a,{publicPath:s})),e.use(n(12)(l)),e.use(s,r.static(u)),e.use(n(11)(a,{serverRendererOptions:{outputPath:u}})),e.set("views",(0,o.join)(__dirname,"../public/views"))})(p),(0,i.log)("info","Configuring server engine..."),p.set("view engine","ejs"),p.set("port",l);let d=p.listen(p.get("port"),()=>{(0,i.log)("info",`Server listening on port ${p.get("port")}...`),s.default.start(d)})},function(e,t){e.exports=require("babel-polyfill")},function(e,t,n){n(25),e.exports=n(24)}]);